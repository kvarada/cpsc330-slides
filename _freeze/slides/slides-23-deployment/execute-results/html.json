{
  "hash": "71074173604f133bc08a0c89be7e2bbd",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"CPSC 330 Lecture 23: Deployment and conclusion\"\nauthor: \"Varada Kolhatkar\"\nformat: \n    revealjs:\n      html-math-method: mathjax    \n      embed-resources: true\n      slide-number: true\n      logo: img/UBC-CS-logo.png\n      resources:\n        - data/\n        - img/        \n---\n\n\n\n## Announcements\n\n- Last lecture today ü•∫! \n- HW9 is due Friday, Dec 5th at 11:59 PM (No late submission allowed.)\n- My OH next week has been moved to 11 AM. Do you prefer in-person or Zoom OH? \n- For an in-person OH I'll book a larger room. \n\n## iClicker \n\nWhat percentage of machine learning projects do you think never make it into production?\n\n- (A) Between 20-30%\n- (B) Around 50%\n- (C) Between 60-70%\n- (D) Between 80-90%\n\n[Source](https://venturebeat.com/ai/why-do-87-of-data-science-projects-never-make-it-into-production)\n\n## Model deployment \n\n**Model deployment** is the process of making machibe learing model available for use in production enviroments. \n\n- Carefully development machine learning models is only half the story. \n- The real challenge in practice is getting ML to work reliably in the real world!! \n\n## Model deployment {.smaller}\n\nModel deployment is a complex, multi-step process that requires making several important decisions, such as:\n\n- Choosing the right infrastructure: What hardware or cloud resources are needed (CPU, GPU, memory, storage)?\n- Meeting performance requirements: What latency and throughput do users expect?\n- Planning for scale: How many users or requests per second must the system support, now and in the future?\n- Monitoring in production: How will you track model performance, data drift, and system health over time?\n- Managing model updates: When deploying a new version, how do you verify that it actually performs better than the current model (e.g., A/B tests)?\n\n## Goal of this lecture\n\nTo demonstrate, through a simple example, how you can take the models you've built in this course (or in your side projects) and deploy them in a lightweight, real-world setting.\n\n## ‚ùì‚ùì Questions for you {.smaller}\n\nImagine you've created a machine learning model and are eager to share it with others. Consider the following scenarios for sharing your model:\n\n- **To a non-technical Audience:** How would you present your model to friends and family who may not have a technical background?\n- **To a technical audience:** How would you share your model with peers or professionals in the field who have a technical understanding of machine learning? \n- **In an academic or research setting:** How would you disseminate your model within academic or research communities?\n\n## Try out this moment predictor\n\n[https://cpsc330-moment-predictor.onrender.com/](https://cpsc330-moment-predictor.onrender.com/)\n\n- In this lecture, I will show you how to set up/develop this. \n\n## What we need? \n\n- After we train a model, we want to use it!\n- The user likely does not want to install your Python stack, train your model.\n- You don't necessarily want to share the dataset.\n- So we need to do two things:\n  1. Save/store your model for later use.\n  2. Make the saved model conveniently accessible.\n\n## We will use the tools below \n\nSaving the model\n\n- [Joblib](https://joblib.readthedocs.io/): A Python library for efficiently saving and loading trained models\n\nMaking the model accessible\n\n- [Flask](https://flask.palletsprojects.com/): A lightweight web framework that lets you create a local API (request $\\rightarrow$ prediction $\\rightarrow$ response)\n- [render](https://render.com/): A cloud service that hosts your Flask app so anyone can access your model online\n(public URL $\\rightarrow$ no need to manage servers)\n\n# [Class demo](https://github.com/UBC-CS/cpsc330-2025W1/blob/main/lectures/102-Varada-lectures/class_demos/demo_24-Deployment.ipynb) \n\n## Course evaluations (~15 mins)\n\nhttps://canvas.ubc.ca/courses/170662/external_tools/53187\n\n- They help us improve our teaching!\n- UBC & CS uses them to provide rewards to instructors and TAs who are doing well!\n- UBC & CS uses them to identify where instructors, TAs and courses need additional supports to improve.\n- UBC uses these in evaluating professors for tenure and promotion.\n- I'll very much appreciate your constructive and concrete feedback.  \n\n## What did we cover \n\n- Part 1: Supervised learning on tabular data: ML fundamentals, preprocessing and data encoding, a bunch of models, evaluation metrics, feature importances and model transparency, feature selection, hyperparameter optimization\n \n- Part 2: Dealing with other non-tabular data types: Clustering, recommender systems, computer vision with pre-trained deep learning models (high level), language data, text preprocessing, embeddings, topic modeling, time series, right-censored data / survival analysis\n\n- Part 3: Communication, ethics, and deployment\n\n## What we didn't cover \n- How do these models work under the hood \n\n![](img/modular-ML.png)\n\n## What next?\n\nIf you want to further develop your machine learning skills:\n\n- Practice!\n- Work on your own projects. Make your work available and reproducible. \n\n- If you are interested in research in machine learning\n  - Take CPSC 340. If you do not have the required prereqs you can try to audit it.\n  - Get into the habit of reading papers and replicating results\n\n\n## ‚ùì‚ùì Questions for you\n\nFor each of the scenarios below \n\n- Identify if ML is a good solution for a problem. If yes\n    - Frame the problem to a ML problem.\n    - Discuss what kind of features you would need to effectively solve the problem\n    - What would be a reasonable baseline? \n    - Which model would be a suitable model for the given scenario? \n    - What would be the appropriate success metrics.\n\n## QueuePredictor app with call-level data {.smaller .scrollable}\n\n:::: {.columns}\n:::{.column width=\"50%\"}\n\n::: {#8bc00889 .cell execution_count=2}\n\n::: {.cell-output .cell-output-display execution_count=2}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>call_id</th>\n      <th>arrival_time</th>\n      <th>queue_len_at_arrival</th>\n      <th>agents_on_duty</th>\n      <th>is_vip</th>\n      <th>wait_time_sec</th>\n      <th>answered</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>2025-01-01 09:01:43</td>\n      <td>8</td>\n      <td>10</td>\n      <td>1</td>\n      <td>128</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>2025-01-01 09:03:03</td>\n      <td>1</td>\n      <td>5</td>\n      <td>0</td>\n      <td>15</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>2025-01-01 09:04:09</td>\n      <td>2</td>\n      <td>8</td>\n      <td>1</td>\n      <td>11</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>2025-01-01 09:04:48</td>\n      <td>13</td>\n      <td>10</td>\n      <td>1</td>\n      <td>171</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>2025-01-01 09:05:31</td>\n      <td>6</td>\n      <td>10</td>\n      <td>1</td>\n      <td>67</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>6</td>\n      <td>2025-01-01 09:07:10</td>\n      <td>10</td>\n      <td>7</td>\n      <td>0</td>\n      <td>95</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>7</td>\n      <td>2025-01-01 09:08:25</td>\n      <td>12</td>\n      <td>6</td>\n      <td>0</td>\n      <td>142</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>8</td>\n      <td>2025-01-01 09:09:02</td>\n      <td>3</td>\n      <td>9</td>\n      <td>0</td>\n      <td>32</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>9</td>\n      <td>2025-01-01 09:10:15</td>\n      <td>7</td>\n      <td>8</td>\n      <td>1</td>\n      <td>89</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>10</td>\n      <td>2025-01-01 09:11:30</td>\n      <td>15</td>\n      <td>5</td>\n      <td>0</td>\n      <td>210</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>11</td>\n      <td>2025-01-01 09:12:45</td>\n      <td>4</td>\n      <td>9</td>\n      <td>0</td>\n      <td>43</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>12</td>\n      <td>2025-01-01 09:14:02</td>\n      <td>9</td>\n      <td>7</td>\n      <td>1</td>\n      <td>115</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>13</td>\n      <td>2025-01-01 09:15:20</td>\n      <td>11</td>\n      <td>6</td>\n      <td>0</td>\n      <td>78</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>14</td>\n      <td>2025-01-01 09:16:35</td>\n      <td>5</td>\n      <td>10</td>\n      <td>0</td>\n      <td>51</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>15</td>\n      <td>2025-01-01 09:17:48</td>\n      <td>14</td>\n      <td>5</td>\n      <td>0</td>\n      <td>188</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>16</td>\n      <td>2025-01-01 09:19:01</td>\n      <td>2</td>\n      <td>8</td>\n      <td>1</td>\n      <td>22</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>17</td>\n      <td>2025-01-01 09:20:15</td>\n      <td>8</td>\n      <td>9</td>\n      <td>0</td>\n      <td>102</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>18</td>\n      <td>2025-01-01 09:21:30</td>\n      <td>13</td>\n      <td>6</td>\n      <td>0</td>\n      <td>165</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>19</td>\n      <td>2025-01-01 09:22:42</td>\n      <td>6</td>\n      <td>10</td>\n      <td>1</td>\n      <td>73</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>20</td>\n      <td>2025-01-01 09:23:55</td>\n      <td>3</td>\n      <td>9</td>\n      <td>0</td>\n      <td>38</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n:::\n:::{.column width=\"50%\"}\n**Scenario:** A call center wants to inform callers of their expected wait time when they join the queue.\n\n**Available data:** Historical calls with both completed (answered) and abandoned (hung up) calls.\n\n:::\n::::\n\n## QueuePredictor app with interval data {.smaller .scrollable}\n\n:::: {.columns}\n:::{.column width=\"50%\" .smaller .scrollable}\n\n::: {#698b1de3 .cell execution_count=3}\n\n::: {.cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>interval_start</th>\n      <th>calls_arrived</th>\n      <th>avg_wait_time_sec</th>\n      <th>callers_abandoned</th>\n      <th>avg_queue_len</th>\n      <th>avg_agents_on_duty</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>2025-01-01 09:00:00</td>\n      <td>4</td>\n      <td>81.25</td>\n      <td>0</td>\n      <td>6.00</td>\n      <td>8.25</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2025-01-01 09:05:00</td>\n      <td>7</td>\n      <td>54.29</td>\n      <td>1</td>\n      <td>5.29</td>\n      <td>8.71</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2025-01-01 09:10:00</td>\n      <td>3</td>\n      <td>37.00</td>\n      <td>0</td>\n      <td>4.00</td>\n      <td>9.00</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>2025-01-01 09:15:00</td>\n      <td>4</td>\n      <td>147.00</td>\n      <td>1</td>\n      <td>11.75</td>\n      <td>7.00</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>2025-01-01 09:20:00</td>\n      <td>3</td>\n      <td>99.67</td>\n      <td>1</td>\n      <td>7.00</td>\n      <td>7.00</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n:::\n:::{.column width=\"50%\"}\n**Scenario:** Same problem, but data is aggregated by 5-minute intervals instead of individual calls.\n\n**Available data:** Each row represents a time window with summary statistics.\n\n:::\n::::\n\n## ‚ùì‚ùì More scenarios for practice {.smaller}\n\n\n|     App           | Goal | \n|-------------------|--------------------------|\n| To-doList App    | Keep track of the tasks that a user inputs and organize them by date | \n| SegmentSphere App | To segment customers to tailor marketing strategies based on purchasing behavior |\n| Video app\t        | Recommend useful videos|\n| Dining app        | Identify cuisine by a restaurant's menu|\n| Weather app       | Calculate precipitation in six hour increments for a geographic region  |\n| EvoCarShare app   | Calculate number of car rentals in four increaments at a particular Evo parking spot |\n| Pharma app| Understand the effect of a new drug on patient survival time |\n\n## Conclusion & farewell {.smaller}\n\nThat's all! We made it! I hope you learned something useful from the course. You all are wonderful students and I had fun teaching this course ‚ô•Ô∏è!\n\n![](img/eva-thank-you.png)\n\nIf you didn‚Äôt fill out course evaluations during class , it‚Äôll be great if you can fill them in when you get a chance.\n\n## Time permitting \n\n- Class picture üòä\n\n![](img/eva-photo.png)\n\n",
    "supporting": [
      "slides-23-deployment_files/figure-revealjs"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}